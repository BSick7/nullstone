var nullstone;!function(a){a.version="0.3.10"}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function b(){}return b.prototype.loadAsync=function(b,c){var d=b+"/"+c;return a.async.create(function(b,c){require([d],function(a){b(a)},function(b){return c(new a.DirLoadError(d,b))})})},b.prototype.resolveType=function(a,b,c){return c.isPrimitive=!1,c.type=require(a+"/"+b),void 0!==c.type},b}();a.DirResolver=b}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function a(a){this.Object=a}return a.fromAny=function(a,b,c){if("number"==typeof b)return b;if(!b)return c||0;var d=a[b.toString()];return null==d?c||0:d},a}();a.Enum=b}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function a(){this.$$callbacks=[],this.$$scopes=[]}return Object.defineProperty(a.prototype,"has",{get:function(){return this.$$callbacks.length>0},enumerable:!0,configurable:!0}),a.prototype.on=function(a,b){this.$$callbacks.push(a),this.$$scopes.push(b)},a.prototype.off=function(a,b){for(var c=this.$$callbacks,d=this.$$scopes,e=c.length-1;e>-1;)e=c.lastIndexOf(a,e),d[e]===b&&(c.splice(e,1),d.splice(e,1)),e--},a.prototype.raise=function(a,b){for(var c=0,d=this.$$callbacks.slice(0),e=this.$$scopes.slice(0),f=d.length;f>c;c++)d[c].call(e[c],a,b)},a.prototype.raiseAsync=function(a,b){var c=this;window.setTimeout(function(){return c.raise(a,b)},1)},a}();a.Event=b}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function b(a){Object.defineProperty(this,"name",{value:a,writable:!1})}return b.prototype.is=function(b){if(!b)return!1;for(var c=b.constructor;c;){var d=c.$$interfaces;if(d&&d.indexOf(this)>-1)return!0;c=a.getTypeParent(c)}return!1},b.prototype.as=function(a){return this.is(a)?a:void 0},b.prototype.mark=function(b){return a.addTypeInterfaces(b,this),this},b}();a.Interface=b}(nullstone||(nullstone={}));var nullstone;!function(a){a.ICollection_=new a.Interface("ICollection")}(nullstone||(nullstone={}));var nullstone;!function(a){a.IEnumerable_=new a.Interface("IEnumerable"),a.IEnumerable_.is=function(a){return a&&a.getEnumerator&&"function"==typeof a.getEnumerator},a.IEnumerable_.empty={getEnumerator:function(){return a.IEnumerator_.empty}},a.IEnumerable_.fromArray=function(b){return{$$arr:b,getEnumerator:function(b){return a.IEnumerator_.fromArray(this.$$arr,b)}}},a.IEnumerable_.toArray=function(a){for(var b=[],c=a.getEnumerator();c.moveNext();)b.push(c.current);return b}}(nullstone||(nullstone={}));var nullstone;!function(a){a.IEnumerator_=new a.Interface("IEnumerator"),a.IEnumerator_.empty={current:void 0,moveNext:function(){return!1}},a.IEnumerator_.fromArray=function(a,b){var c,d=a.length,e={moveNext:void 0,current:void 0};return b?(c=d,e.moveNext=function(){return c--,0>c?(e.current=void 0,!1):(e.current=a[c],!0)}):(c=-1,e.moveNext=function(){return c++,c>=d?(e.current=void 0,!1):(e.current=a[c],!0)}),e}}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function b(){}return Object.defineProperty(b.prototype,"propertyType",{get:function(){return void 0},enumerable:!0,configurable:!0}),b.prototype.getValue=function(a,b){return this.GetFunc?this.GetFunc.call(a,b):void 0},b.prototype.setValue=function(a,b,c){this.SetFunc&&this.SetFunc.call(a,b,c)},b.find=function(c){var d=c,e=c instanceof Function;if(e&&(d=new c),d instanceof Array){var f=new b;return f.GetFunc=function(a){return this[a]},f.SetFunc=function(a,b){this[a]=b},f}var g=a.ICollection_.as(d);if(g){var f=new b;return f.GetFunc=function(a){return this.GetValueAt(a)},f.SetFunc=function(a,b){return this.SetValueAt(a,b)},f}},b}();a.IndexedPropertyInfo=b}(nullstone||(nullstone={}));var nullstone;!function(a){function b(a,b){a.$$uri||Object.defineProperty(a,"$$uri",{value:b.toString(),enumerable:!1})}var c=function(){function c(b){this.$$module=null,this.$$sourcePath=null,this.$$primtypes={},this.$$types={},this.$$loaded=!1,Object.defineProperty(this,"name",{value:b,writable:!1});var c=b;0!==b.indexOf("http://")&&(c="lib://"+b),Object.defineProperty(this,"uri",{value:new a.Uri(c),writable:!1})}return Object.defineProperty(c.prototype,"sourcePath",{get:function(){var a=this.$$sourcePath||"lib/"+this.name+"/dist/"+this.name;return this.useMin?a+".min":a},set:function(a){".js"===a.substr(a.length-3)&&(a=a.substr(0,a.length-3)),this.useMin&&".min"===a.substr(a.length-4)&&(a=a.substr(0,a.length-4)),this.$$sourcePath=a},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"rootModule",{get:function(){return this.$$module=this.$$module||require(this.sourcePath)},enumerable:!0,configurable:!0}),c.prototype.loadAsync=function(){var b=this;return this.$$sourcePath||"http"!==this.uri.scheme||(this.$$loaded=!0),this.$$loaded?a.async.resolve(this):(this.$configModule(),a.async.create(function(c,d){require([b.name],function(a){b.$$module=a,b.$$loaded=!0,c(b)},function(c){return d(new a.LibraryLoadError(b,c))})}))},c.prototype.$configModule=function(){var a={paths:{},shim:{},map:{"*":{}}},b=this.sourcePath;a.paths[this.name]=b,a.shim[this.name]={exports:this.exports,deps:this.deps},a.map["*"][b]=this.name,require.config(a)},c.prototype.resolveType=function(a,c,d){if(!a)return d.isPrimitive=!0,void 0!==(d.type=this.$$primtypes[c])?!0:(d.isPrimitive=!1,void 0!==(d.type=this.$$types[c]));var e=this.rootModule;if(d.isPrimitive=!1,d.type=void 0,"/"!==a)for(var f=0,g=a.substr(1).split(".");f<g.length&&e;f++)e=e[g[f]];if(!e)return!1;d.type=e[c];var h=d.type;return void 0===h?!1:(b(h,this.uri),!0)},c.prototype.add=function(c,d){if(!c)throw new Error("A type must be specified when registering '"+d+"'`.");if(d=d||a.getTypeName(c),!d)throw new Error("No type name found.");return b(c,this.uri),this.$$types[d]=c,this},c.prototype.addPrimitive=function(c,d){if(!c)throw new Error("A type must be specified when registering '"+d+"'`.");if(d=d||a.getTypeName(c),!d)throw new Error("No type name found.");return b(c,this.uri),this.$$primtypes[d]=c,this},c.prototype.addEnum=function(a,b){return this.addPrimitive(a,b),Object.defineProperty(a,"$$enum",{value:!0,writable:!1}),a.name=b,this},c}();a.Library=c}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function b(){this.$$libs={},this.libraryCreated=new a.Event,this.dirResolver=new a.DirResolver}return b.prototype.createLibrary=function(b){return new a.Library(b)},b.prototype.loadTypeAsync=function(b,c){var d=this.resolve(b);return d?a.async.create(function(a,b){d.loadAsync().then(function(b){var d={isPrimitive:!1,type:void 0};a(b.resolveType(null,c,d)?d.type:null)},b)}):this.dirResolver.loadAsync(b,c)},b.prototype.resolve=function(b){var c=new a.Uri(b),d=c.scheme;if(!d)return null;var e="lib"===d?c.host:b,f=this.$$libs[e];return f||(f=this.$$libs[e]=this.createLibrary(e),this.$$onLibraryCreated(f)),f},b.prototype.resolveType=function(b,c,d){var e=new a.Uri(b),f=e.scheme;if(!f)return this.dirResolver.resolveType(b,c,d);var g="lib"===f?e.host:b,h="lib"===f?e.absolutePath:"",i=this.$$libs[g];return i||(i=this.$$libs[g]=this.createLibrary(g),this.$$onLibraryCreated(i)),i.resolveType(h,c,d)},b.prototype.$$onLibraryCreated=function(a){this.libraryCreated.raise(this,Object.freeze({library:a}))},b}();a.LibraryResolver=b}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function a(a){this.$$cache={},this.$$creator=a}return a.prototype.memoize=function(a){var b=this.$$cache[a];return b||(this.$$cache[a]=b=this.$$creator(a)),b},a}();a.Memoizer=b}(nullstone||(nullstone={}));var nullstone;!function(a){function b(a,b){if(!a)return void 0;var c=a.constructor,d=Object.getOwnPropertyDescriptor(c.prototype,b);return d?d:Object.getOwnPropertyDescriptor(a,b)}function c(a,b){if(!a)return!1;if(a.hasOwnProperty(b))return!0;var c=a.constructor;return c.prototype.hasOwnProperty(b)}a.getPropertyDescriptor=b,a.hasProperty=c}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function b(){}return b.prototype.getValue=function(a){return this.$$getFunc?this.$$getFunc.call(a):void 0},b.prototype.setValue=function(a,b){return this.$$setFunc?this.$$setFunc.call(a,b):void 0},b.find=function(c,d){var e=c,f=c instanceof Function;if(f&&(e=new c),!(e instanceof Object))return null;var g=d,h=a.getPropertyDescriptor(e,d);if(h){var i=new b;return i.name=d,i.$$getFunc=h.get,i.$$getFunc||(i.$$getFunc=function(){return this[g]}),i.$$setFunc=h.set,!i.$$setFunc&&h.writable&&(i.$$setFunc=function(a){this[g]=a}),i}var j=f?c:c.constructor,i=new b;return i.name=d,i.$$getFunc=j.prototype["Get"+d],i.$$setFunc=j.prototype["Set"+d],i},b}();a.PropertyInfo=b}(nullstone||(nullstone={}));var nullstone;!function(a){function b(a){var b=a;if(!b)return"";var c=b.name;if(c)return c;var c=b.toString().match(/function ([^\(]+)/)[1];return Object.defineProperty(b,"name",{enumerable:!1,value:c,writable:!1}),c}function c(a){if(a===Object)return null;var b=a.$$parent;if(!b){if(!a.prototype)return void 0;b=Object.getPrototypeOf(a.prototype).constructor,Object.defineProperty(a,"$$parent",{value:b,writable:!1})}return b}function d(a){for(var b=[],c=0;c<arguments.length-1;c++)b[c]=arguments[c+1];if(b){for(var d=0,e=b.length;e>d;d++)if(!b[d]){console.warn("Registering undefined interface on type.",a);break}Object.defineProperty(a,"$$interfaces",{value:b,writable:!1})}}function e(a,b){for(var d=a;d&&d!==b;)d=c(d);return null!=d}a.getTypeName=b,a.getTypeParent=c,a.addTypeInterfaces=d,a.doesInheritFrom=e}(nullstone||(nullstone={}));var nullstone;!function(a){function b(b,c){var d=f[c];if(d)return d(b);if(c instanceof a.Enum){var e=c.Object;return e.Converter?e.Converter(b):(b=b||0,"string"==typeof b?e[b]:b)}return b}function c(a,b){return a?b[a]:0}function d(a,b){f[a]=b}function e(a,b){a.Converter=b}var f=[];f[Boolean]=function(a){if(null==a)return null;if("boolean"==typeof a)return a;var b=a.toString().toUpperCase();return"TRUE"===b?!0:"FALSE"===b?!1:null},f[String]=function(a){return null==a?"":a.toString()},f[Number]=function(a){return a?"number"==typeof a?a:parseFloat(a.toString()):0},f[Date]=function(a){return new Date(null==a?0:a.toString())},f[RegExp]=function(a){if(a instanceof RegExp)return a;if(a=null)throw new Error("Cannot specify an empty RegExp.");return a=a.toString(),new RegExp(a)},a.convertAnyToType=b,a.convertStringToEnum=c,a.registerTypeConverter=d,a.registerEnumConverter=e}(nullstone||(nullstone={}));var nullstone;!function(a){!function(a){a[a.RelativeOrAbsolute=0]="RelativeOrAbsolute",a[a.Absolute=1]="Absolute",a[a.Relative=2]="Relative"}(a.UriKind||(a.UriKind={}));var b=(a.UriKind,function(){function a(b,c){"string"==typeof b?(this.$$originalString=b,this.$$kind=c||0):b instanceof a&&(this.$$originalString=b.$$originalString,this.$$kind=b.$$kind)}return Object.defineProperty(a.prototype,"kind",{get:function(){return this.$$kind},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"host",{get:function(){var a=this.$$originalString,b=Math.max(3,a.indexOf("://")+3),c=a.indexOf("/",b);return 0>c?a.substr(b):a.substr(b,c-b)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"absolutePath",{get:function(){var a=this.$$originalString,b=Math.max(3,a.indexOf("://")+3),c=a.indexOf("/",b);if(0>c||b>c)return"/";var d=a.indexOf("?",c);return 0>d||c>d?a.substr(c):a.substr(c,d-c)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scheme",{get:function(){var a=this.$$originalString,b=a.indexOf("://");return 0>b?null:a.substr(0,b)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fragment",{get:function(){var a=this.$$originalString,b=a.indexOf("#");return 0>b?"":a.substr(b)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"originalString",{get:function(){return this.$$originalString.toString()},enumerable:!0,configurable:!0}),a.prototype.toString=function(){return this.$$originalString.toString()},a.prototype.equals=function(a){return this.$$originalString===a.$$originalString},a.isNullOrEmpty=function(a){return null==a?!0:!a.$$originalString},a}());a.Uri=b,a.registerTypeConverter(b,function(a){return null==a&&(a=""),new b(a.toString())})}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function b(b,c){this.defaultUri=b,this.xUri=c,this.libResolver=new a.LibraryResolver,this.libResolver.resolve(b).add(Array,"Array"),this.libResolver.resolve(c).addPrimitive(String,"String").addPrimitive(Number,"Number").addPrimitive(Number,"Double").addPrimitive(Date,"Date").addPrimitive(RegExp,"RegExp").addPrimitive(Boolean,"Boolean").addPrimitive(a.Uri,"Uri")}return b.prototype.resolveLibrary=function(a){return this.libResolver.resolve(a||this.defaultUri)},b.prototype.loadTypeAsync=function(a,b){return this.libResolver.loadTypeAsync(a||this.defaultUri,b)},b.prototype.resolveType=function(a,b,c){return c.isPrimitive=!1,c.type=void 0,this.libResolver.resolveType(a||this.defaultUri,b,c)},b.prototype.add=function(a,b,c){var d=this.libResolver.resolve(a||this.defaultUri);return d&&d.add(c,b),this},b.prototype.addPrimitive=function(a,b,c){var d=this.libResolver.resolve(a||this.defaultUri);return d&&d.addPrimitive(c,b),this},b.prototype.addEnum=function(a,b,c){var d=this.libResolver.resolve(a||this.defaultUri);return d&&d.addEnum(c,b),this},b}();a.TypeManager=b}(nullstone||(nullstone={}));var nullstone;!function(a){function b(a,b,c,d){var e=a,f=e.$$annotations;f||Object.defineProperty(e,"$$annotations",{value:f=[],writable:!1});var g=f[b];if(g||(f[b]=g=[]),d&&g.length>0)throw new Error("Only 1 '"+b+"' annotation allowed per type ["+a.constructor.name+"].");g.push(c)}function c(a,b){var c=a,d=c.$$annotations;return d?(d[b]||[]).slice(0):void 0}function d(a){function d(c){for(var d=[],e=0;e<arguments.length-1;e++)d[e]=arguments[e+1];for(var f=0,g=d.length;g>f;f++)b(c,a,d[f])}return d.Get=function(b){return c(b,a)},d}a.Annotation=b,a.GetAnnotations=c,a.CreateTypedAnnotation=d}(nullstone||(nullstone={}));var nullstone;!function(a){!function(b){function c(a){function b(a){f=a,d&&d(a)}function c(a){g=a,e&&e(a)}var d,e,f,g;a(b,c);var h={then:function(a,b){return d=a,e=b,void 0!==f?d&&d(f):void 0!==g&&e&&e(g),h}};return h}function d(a){return b.create(function(b){b(a)})}function e(a){return b.create(function(b,c){c(a)})}function f(b){return!b||b.length<1?d([]):c(function(c,d){function e(b,e,k){f[b]=e,g[b]=k,j=j||void 0!==k,h++,h>=i&&(j?d(new a.AggregateError(g)):c(f))}for(var f=new Array(b.length),g=new Array(b.length),h=0,i=b.length,j=!1,k=0;i>k;k++)b[k].then(function(a){return e(k,a,void 0)},function(a){return e(k,void 0,a)})})}b.create=c,b.resolve=d,b.reject=e,b.many=f}(a.async||(a.async={}));a.async}(nullstone||(nullstone={}));var nullstone;!function(a){function b(a,b){return null==a&&null==b?!0:null==a||null==b?!1:a===b?!0:!!a.equals&&a.equals(b)}a.equals=b}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function a(a){this.errors=a.filter(function(a){return!!a}),Object.freeze(this)}return Object.defineProperty(a.prototype,"flat",{get:function(){for(var b=[],c=0,d=this.errors;c<d.length;c++){var e=d[c];e instanceof a?b=b.concat(e.flat):b.push(e)}return b},enumerable:!0,configurable:!0}),a}();a.AggregateError=b}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function a(a,b){this.path=a,this.error=b,Object.freeze(this)}return a}();a.DirLoadError=b}(nullstone||(nullstone={}));var nullstone;!function(a){var b=function(){function a(a,b){this.library=a,this.error=b,Object.freeze(this)}return a}();a.LibraryLoadError=b}(nullstone||(nullstone={}));var nullstone;!function(a){!function(a){function b(a,b,d,e){return a?("function"==typeof a.resolveTypeFields&&a.resolveTypeFields(function(a){return c(a,b,d)}),"function"==typeof a.transmute?a.transmute(e):a):a}function c(a,b,c){var d=null,e=a,f=e.indexOf(":");f>-1&&(d=e.substr(0,f),e=e.substr(f+1));var g=b.lookupNamespaceURI(d),h=c(g,e);return h.type}a.finishMarkupExtension=b}(a.markup||(a.markup={}));a.markup}(nullstone||(nullstone={}));var nullstone;!function(a){!function(b){function c(a){return{resolveType:a.resolveType||function(){return d},resolveObject:a.resolveObject||function(a){return new a},resolvePrimitive:a.resolvePrimitive||function(a,b){return new a(b)},resolveResources:a.resolveResources||function(){return new Object},branchSkip:a.branchSkip||function(){},object:a.object||function(){},objectEnd:a.objectEnd||function(){},contentText:a.contentText||function(){},name:a.name||function(){},propertyStart:a.propertyStart||function(){},propertyEnd:a.propertyEnd||function(){},attributeStart:a.attributeStart||function(){},attributeEnd:a.attributeEnd||function(){},error:a.error||function(){return!0},end:a.end||function(){}}}b.NO_PARSER={on:function(){return b.NO_PARSER},setNamespaces:function(){return b.NO_PARSER},setExtensionParser:function(){return b.NO_PARSER},parse:function(){},skipBranch:function(){},resolvePrefix:function(){return""},walkUpObjects:function(){return a.IEnumerator_.empty}};var d={isPrimitive:!1,type:Object};b.createMarkupSax=c}(a.markup||(a.markup={}));a.markup}(nullstone||(nullstone={}));var nullstone;!function(a){!function(b){var c=function(){function c(b){this.uri=new a.Uri(b)}return c.prototype.createParser=function(){return b.NO_PARSER},c.prototype.resolve=function(a,c){var d=new b.MarkupDependencyResolver(a,this.createParser());return d.collect(this.root,c),d.resolve()},c.prototype.loadAsync=function(){var b="text!"+this.uri.toString(),c=this;return a.async.create(function(a,d){require([b],function(b){c.setRoot(c.loadRoot(b)),a(c)},d)})},c.prototype.loadRoot=function(a){return a},c.prototype.setRoot=function(a){return this.root=a,this},c}();b.Markup=c}(a.markup||(a.markup={}));a.markup}(nullstone||(nullstone={}));var nullstone;!function(a){!function(b){var c=function(){function b(a,b){this.typeManager=a,this.parser=b,this.$$uris=[],this.$$names=[],this.$$resolving=[]}return b.prototype.collect=function(a,b){var c=this,d={},e={isPrimitive:!1,type:Object},f={uri:"",name:"",obj:void 0},g={resolveType:function(a,b){return c.add(a,b),f.uri=a,f.name=b,e},resolveObject:function(){return d},objectEnd:function(a){f.obj=a},propertyEnd:function(){},attributeEnd:function(){}};b&&(g.propertyEnd=function(a,c){b(f.uri,f.name,c,f.obj)},g.attributeEnd=function(a,c,d){b(f.uri,f.name,c,d)}),this.parser.on(g).parse(a)},b.prototype.add=function(a,b){var c=this.$$uris,d=this.$$names,e=c.indexOf(a);return e>-1&&d[e]===b?!1:this.$$resolving.indexOf(a+"/"+b)>-1?!1:(c.push(a),d.push(b),!0)},b.prototype.resolve=function(){for(var b=[],c=0,d=this.$$uris,e=this.$$names,f=this.typeManager,g=this.$$resolving;c<d.length;c++){var h=d[c],i=e[c];g.push(h+"/"+i),b.push(f.loadTypeAsync(h,i))}return a.async.many(b)},b}();b.MarkupDependencyResolver=c}(a.markup||(a.markup={}));a.markup}(nullstone||(nullstone={}));var nullstone;!function(a){!function(a){!function(b){function c(a){if(!a)return!1;var b=a[0].toUpperCase().charCodeAt(0);return b>=65&&90>=b}var d=function(){function d(){this.$$defaultXmlns="http://schemas.wsick.com/fayde",this.$$xXmlns="http://schemas.wsick.com/fayde/x"}return d.prototype.setNamespaces=function(a,b){return this.$$defaultXmlns=a,this.$$xXmlns=b,this},d.prototype.parse=function(b,d,e){if(!c(b[1]))return b;this.$$ensure();var f={text:b,i:1,acc:"",error:"",resolver:d},g=this.$$doParse(f,e);return f.error&&this.$$onError(f.error),g=a.finishMarkupExtension(g,d,this.$$onResolveType,e)},d.prototype.$$doParse=function(a,b){if(!this.$$parseName(a))return void 0;for(this.$$startExtension(a,b);a.i<a.text.length&&this.$$parseKeyValue(a,b)&&"}"!==a.text[a.i];);return b.pop()},d.prototype.$$parseName=function(a){var b=a.text.indexOf(" ",a.i);return b>a.i?(a.acc=a.text.substr(a.i,b-a.i),a.i=b+1,!0):(b=a.text.indexOf("}",a.i),b>a.i?(a.acc=a.text.substr(a.i,b-a.i),a.i=b,!0):(a.error="Missing closing bracket.",!1))},d.prototype.$$startExtension=function(a,c){var d,e=a.acc,f=e.indexOf(":"),g=0>f?null:e.substr(0,f),h=0>f?e:e.substr(f+1),i=g?a.resolver.lookupNamespaceURI(g):b.DEFAULT_XMLNS;if(i===this.$$xXmlns)if("Null"===h)d=this.$$parseXNull(a);else if("Type"===h)d=this.$$parseXType(a);else{if("Static"!==h)throw new Error("Unknown markup extension. ["+g+":"+h+"]");d=this.$$parseXStatic(a)}else{var j=this.$$onResolveType(i,h);d=this.$$onResolveObject(j.type)}c.push(d)},d.prototype.$$parseXNull=function(a){var b=a.text.indexOf("}",a.i);if(b<a.i)throw new Error("Unterminated string constant.");return a.i=b,null},d.prototype.$$parseXType=function(a){var b=a.text.indexOf("}",a.i);if(b<a.i)throw new Error("Unterminated string constant.");var c=a.text.substr(a.i,b-a.i);a.i=b;var d=c.indexOf(":"),e=0>d?null:c.substr(0,d),f=0>d?c:c.substr(d+1),g=a.resolver.lookupNamespaceURI(e),h=this.$$onResolveType(g,f);return h.type},d.prototype.$$parseXStatic=function(a){for(var b=a.text,c=b.length,d=a.i;a.i<c&&("}"!==b[a.i]||"\\"===b[a.i-1]);a.i++);var e=b.substr(d,a.i-d),f=new Function("return ("+e+");");return f()},d.prototype.$$parseKeyValue=function(a,b){var d=a.text;a.acc="";for(var e="",f=void 0,g=d.length,h=!1;a.i<g;a.i++){var i=d[a.i];if("\\"===i)a.i++,a.acc+=d[a.i];else if("{"===i){if(h||!c(d[a.i+1])){a.acc+=i,h=!0;continue}if(!e)return a.error="A sub extension must be set to a key.",!1;if(a.i++,f=this.$$doParse(a,b),a.error)return!1}else if("="===i)e=a.acc.trim(),a.acc="";else{if("}"===i)return h&&(h=!1,a.acc+=i),this.$$finishKeyValue(a,e,f,b),!0;if(","===i)return a.i++,this.$$finishKeyValue(a,e,f,b),!0;e&&!a.acc&&"'"===i?(a.i++,this.$$parseSingleQuoted(a),f=a.acc,a.acc=""):a.acc+=i}}throw new Error("Unterminated string constant.")},d.prototype.$$finishKeyValue=function(b,c,d,e){if(void 0!==d||(d=b.acc.trim())){d=a.finishMarkupExtension(d,b.resolver,this.$$onResolveType,e);var f=e[e.length-1];c?f[c]=d:f.init&&f.init(d)}},d.prototype.$$parseSingleQuoted=function(a){for(var b=a.text,c=b.length;a.i<c;a.i++){var d=b[a.i];if("\\"===d)a.i++,a.acc+=b[a.i];else{if("'"===d)return;a.acc+=d}}},d.prototype.$$ensure=function(){this.onResolveType(this.$$onResolveType).onResolveObject(this.$$onResolveObject).onError(this.$$onError)},d.prototype.onResolveType=function(a){var b={isPrimitive:!1,type:Object};return this.$$onResolveType=a||function(){return b},this},d.prototype.onResolveObject=function(a){return this.$$onResolveObject=a||function(a){return new a},this},d.prototype.onResolvePrimitive=function(a){return this.$$onResolvePrimitive=a||function(a,b){return new a(b)},this},d.prototype.onError=function(a){return this.$$onError=a||function(){},this},d}();b.XamlExtensionParser=d}(a.xaml||(a.xaml={}));a.xaml}(a.markup||(a.markup={}));a.markup}(nullstone||(nullstone={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},nullstone;!function(a){!function(b){!function(c){var d=new DOMParser,e=new a.Memoizer(function(a){return new f(a)}),f=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.create=function(a){return e.memoize(a.toString())},b.prototype.createParser=function(){return new c.XamlParser},b.prototype.loadRoot=function(a){var b=d.parseFromString(a,"text/xml");return b.documentElement},b}(b.Markup);c.XamlMarkup=f}(b.xaml||(b.xaml={}));b.xaml}(a.markup||(a.markup={}));a.markup}(nullstone||(nullstone={}));var nullstone;!function(a){!function(a){!function(b){function c(a,b,c){for(var d=c+".Resources",e=a.firstElementChild;e;){if(e.localName===d&&e.namespaceURI===b)return e;e=e.nextElementSibling}return null}b.DEFAULT_XMLNS="http://schemas.wsick.com/fayde",b.DEFAULT_XMLNS_X="http://schemas.wsick.com/fayde/x";var d="http://www.w3.org/1999/xhtml",e="parsererror",f=function(){function f(){this.$$onEnd=null,this.$$objectStack=[],this.$$skipnext=!1,this.$$curel=null,this.$$curkey=void 0,this.setExtensionParser(new b.XamlExtensionParser).setNamespaces(b.DEFAULT_XMLNS,b.DEFAULT_XMLNS_X).on({})}return f.prototype.on=function(b){return b=a.createMarkupSax(b),this.$$onResolveType=b.resolveType,this.$$onResolveObject=b.resolveObject,this.$$onResolvePrimitive=b.resolvePrimitive,this.$$onResolveResources=b.resolveResources,this.$$onBranchSkip=b.branchSkip,this.$$onObject=b.object,this.$$onObjectEnd=b.objectEnd,this.$$onContentText=b.contentText,this.$$onName=b.name,this.$$onPropertyStart=b.propertyStart,this.$$onPropertyEnd=b.propertyEnd,this.$$onAttributeStart=b.attributeStart,this.$$onAttributeEnd=b.attributeEnd,this.$$onError=b.error,this.$$onEnd=b.end,this.$$extension&&this.$$extension.onResolveType(this.$$onResolveType).onResolveObject(this.$$onResolveObject).onResolvePrimitive(this.$$onResolvePrimitive),this},f.prototype.setNamespaces=function(a,b){return this.$$defaultXmlns=a,this.$$xXmlns=b,this.$$extension&&this.$$extension.setNamespaces(this.$$defaultXmlns,this.$$xXmlns),this},f.prototype.setExtensionParser=function(a){return this.$$extension=a,a&&a.setNamespaces(this.$$defaultXmlns,this.$$xXmlns).onResolveType(this.$$onResolveType).onResolveObject(this.$$onResolveObject).onResolvePrimitive(this.$$onResolvePrimitive).onError(function(a){throw a}),this},f.prototype.parse=function(a){if(!this.$$extension)throw new Error("No extension parser exists on parser.");return this.$$handleElement(a,!0),this.$$destroy(),this},f.prototype.skipBranch=function(){this.$$skipnext=!0},f.prototype.walkUpObjects=function(){var a=this.$$objectStack,b=a.length;return{current:void 0,moveNext:function(){return b--,void 0!==(this.current=a[b])}}},f.prototype.resolvePrefix=function(a){return this.$$curel.lookupNamespaceURI(a)},f.prototype.$$handleElement=function(a,b){var d=this.$$curel;this.$$curel=a;var e=a.localName,f=a.namespaceURI;if(this.$$tryHandleError(a,f,e)||this.$$tryHandlePropertyTag(a,f,e))return void(this.$$curel=d);var g=this.$$objectStack,h=this.$$onResolveType(f,e);if(this.$$tryHandlePrimitive(a,h,b))return void(this.$$curel=d);var i=this.$$onResolveObject(h.type);void 0!==i&&(g.push(i),this.$$onObject(i,b));var j=c(a,f,e);j&&this.$$handleResources(i,h.type,j),this.$$curkey=void 0,this.$$processAttributes(a);var k=this.$$curkey;if(this.$$skipnext)return this.$$skipnext=!1,g.pop(),this.$$onObjectEnd(i,k,b,g[g.length-1]),this.$$onBranchSkip(a.firstElementChild,i),void(this.$$curel=d);for(var l=a.firstElementChild,m=!!l;l;)j&&l===j||this.$$handleElement(l,!0),l=l.nextElementSibling;if(!m){var n=a.textContent;n&&(n=n.trim())&&this.$$onContentText(n)}void 0!==i&&(g.pop(),this.$$onObjectEnd(i,k,b,g[g.length-1])),this.$$curel=d},f.prototype.$$handleResources=function(a,b,c){var d=this.$$objectStack,e=this.$$onResolveResources(a,b);d.push(e),this.$$onObject(e,!1);for(var f=c.firstElementChild;f;)this.$$handleElement(f,!0),f=f.nextElementSibling;d.pop(),this.$$onObjectEnd(e,void 0,!1,d[d.length-1])},f.prototype.$$tryHandleError=function(a,b,c){return b!==d||c!==e?!1:(this.$$onError(new Error(a.textContent)),!0)},f.prototype.$$tryHandlePropertyTag=function(a,b,c){var d=c.indexOf(".");if(0>d)return!1;var e=this.$$onResolveType(b,c.substr(0,d)),f=e.type;c=c.substr(d+1),this.$$onPropertyStart(f,c);for(var g=a.firstElementChild;g;)this.$$handleElement(g,!1),g=g.nextElementSibling;return this.$$onPropertyEnd(f,c),!0},f.prototype.$$tryHandlePrimitive=function(a,b,c){if(!b.isPrimitive)return!1;var d=a.textContent,e=this.$$onResolvePrimitive(b.type,d?d.trim():"");this.$$onObject(e,c),this.$$curkey=void 0,this.$$processAttributes(a);var f=this.$$curkey,g=this.$$objectStack;return this.$$onObjectEnd(e,f,c,g[g.length-1]),!0},f.prototype.$$processAttributes=function(a){for(var b=0,c=a.attributes,d=c.length;d>b;b++)this.$$processAttribute(c[b])},f.prototype.$$processAttribute=function(a){var b=a.prefix,c=a.localName;if(this.$$shouldSkipAttr(b,c))return!0;var d=a.namespaceURI,e=a.value;return this.$$tryHandleXAttribute(d,c,e)?!0:this.$$handleAttribute(d,c,e,a)},f.prototype.$$shouldSkipAttr=function(a,b){return"xmlns"===a?!0:!a&&"xmlns"===b},f.prototype.$$tryHandleXAttribute=function(a,b,c){return a!==this.$$xXmlns?!1:("Name"===b&&this.$$onName(c),"Key"===b&&(this.$$curkey=c),!0)},f.prototype.$$handleAttribute=function(a,b,c,d){var e=null,b=b,f=b.indexOf(".");if(f>-1){var g=this.$$onResolveType(a,b.substr(0,f));e=g.type,b=b.substr(f+1)}this.$$onAttributeStart(e,b);var h=this.$$getAttrValue(c,d);return this.$$onAttributeEnd(e,b,h),!0},f.prototype.$$getAttrValue=function(a,b){return"{"!==a[0]?a:this.$$extension.parse(a,b,this.$$objectStack)},f.prototype.$$destroy=function(){this.$$onEnd&&this.$$onEnd()},f}();b.XamlParser=f}(a.xaml||(a.xaml={}));a.xaml}(a.markup||(a.markup={}));a.markup}(nullstone||(nullstone={}));
//# sourceMappingURL=nullstone.min.map